<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–õ–∏–≥–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Å—Ç–æ–≤</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0b0c10;
      color: #f5f5f5;
      text-align: center;
      margin: 0;
      padding: 15px;
    }
    h1 {
      margin-bottom: 10px;
    }
    .menu {
      margin-bottom: 10px;
    }
    .menu button {
      background: #45f3ff;
      border: none;
      padding: 8px 12px;
      border-radius: 7px;
      margin: 4px;
      cursor: pointer;
      font-size: 14px;
      color: #000;
    }
    .menu button.active {
      background: #00d0e0;
    }
    .screen {
      display: none;
      margin-top: 10px;
      background: #1f2833;
      padding: 15px;
      border-radius: 10px;
    }

    /* –≤—ã–±–æ—Ä –∫–ª—É–±–∞ */
    .club-btn {
      background: #243447;
      padding: 10px;
      margin: 5px auto;
      border-radius: 10px;
      max-width: 280px;
      cursor: pointer;
      border: 1px solid #2e3b4e;
    }
    .club-btn:hover {
      background: #2d3b4d;
    }
    .club-selected {
      border: 2px solid #45f3ff;
      background: #16202a;
    }

    button {
      border: none;
      padding: 7px 12px;
      border-radius: 7px;
      cursor: pointer;
      margin-top: 5px;
    }
    input,
    select {
      padding: 5px;
      border-radius: 5px;
      border: none;
      margin: 3px;
    }
    input[type="number"] {
      width: 70px;
      text-align: center;
    }

    .table-wrapper {
      max-height: 260px;
      overflow-y: auto;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px solid #2e3b4e;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    th,
    td {
      border-bottom: 1px solid #34495e;
      padding: 6px;
    }
    th {
      font-weight: bold;
      position: sticky;
      top: 0;
      background: #1f2833;
    }
    .nick {
      color: #45f3ff;
      cursor: pointer;
    }
    .nick:hover {
      text-decoration: underline;
    }

    .tag {
      display: inline-block;
      background: #17212b;
      border-radius: 999px;
      padding: 4px 10px;
      margin: 3px;
      font-size: 12px;
    }

    .highlight {
      color: #45f3ff;
      font-weight: bold;
    }

    .notice {
      font-size: 12px;
      color: #ccc;
    }

    .closed {
      color: #ff6b6b;
      font-size: 13px;
      font-weight: bold;
    }

    .match-row {
      margin: 8px 0;
    }

    hr {
      border-color: #444;
    }
  </style>
</head>
<body>
  <h1>‚öΩ –õ–∏–≥–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Å—Ç–æ–≤</h1>

  <!-- –≤–µ—Ä—Ö–Ω–µ–µ –º–µ–Ω—é -->
  <div class="menu">
    <button onclick="openScreen('home')">–ì–ª–∞–≤–Ω–∞—è</button>
    <button onclick="openScreen('table')">–¢–∞–±–ª–∏—Ü–∞</button>
    <button onclick="openScreen('predictions')">–ü—Ä–æ–≥–Ω–æ–∑</button>
    <button onclick="openScreen('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
    <button onclick="openScreen('prizes')">–ù–∞–≥—Ä–∞–¥—ã</button>
    <button onclick="openScreen('strike')">üéØ –¢–æ—á–Ω—ã–π —É–¥–∞—Ä</button>
  </div>

  <!-- –í–´–ë–û–† –õ–Æ–ë–ò–ú–û–ì–û –ö–õ–£–ë–ê -->
  <div id="clubSelect">
    <h3>–í—ã–±–µ—Ä–∏ –ª—é–±–∏–º—ã–π –∫–ª—É–± (1 —Ä–∞–∑ –∑–∞ —Å–µ–∑–æ–Ω)</h3>

    <div class="club-btn" onclick="selectClub(this, '–ë–∞—Ä—Å–µ–ª–æ–Ω–∞')">üîµüî¥ –ë–∞—Ä—Å–µ–ª–æ–Ω–∞</div>
    <div class="club-btn" onclick="selectClub(this, '–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥')">‚ö™ –†–µ–∞–ª –ú–∞–¥—Ä–∏–¥</div>
    <div class="club-btn" onclick="selectClub(this, '–ë–∞–≤–∞—Ä–∏—è')">üî¥ –ë–∞–≤–∞—Ä–∏—è</div>
    <div class="club-btn" onclick="selectClub(this, '–ê—Ä—Å–µ–Ω–∞–ª')">üî¥ –ê—Ä—Å–µ–Ω–∞–ª</div>
    <div class="club-btn" onclick="selectClub(this, '–õ–∏–≤–µ—Ä–ø—É–ª—å')">üî¥ –õ–∏–≤–µ—Ä–ø—É–ª—å</div>
    <div class="club-btn" onclick="selectClub(this, '–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥')">üî¥ –ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥</div>
    <div class="club-btn" onclick="selectClub(this, '–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏')">üî∑ –ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏</div>
    <div class="club-btn" onclick="selectClub(this, '–ü–°–ñ')">üîµüî¥ –ü–°–ñ</div>

    <button id="clubConfirm" disabled>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–±–æ—Ä</button>
  </div>

  <!-- –ì–õ–ê–í–ù–ê–Ø -->
  <div id="home" class="screen">
    <h2>–ì–ª–∞–≤–Ω–∞—è</h2>
    <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="homeClub">‚Äî</span></p>
    <p>–¢–≤–æ–∏ –æ—á–∫–∏: <span id="homePoints">0</span></p>
    <p>–¢–≤–æ—ë –º–µ—Å—Ç–æ: <span id="homePlace">‚Äî</span></p>
    <p>
      –ë–∞–ª–∞–Ω—Å:
      <b><span id="homeStars">0</span> ‚≠ê</b>
    </p>
    <p>–ë–∏–ª–µ—Ç—ã –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à: <span id="homeTickets">0</span></p>
    <p class="notice">
      –ë–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞–≤–∫–∏ –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Ç–≤–æ—ë–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (MVP).<br />
      –ü–æ–∑–∂–µ –º—ã –ø—Ä–∏–≤—è–∂–µ–º –≤—Å—ë –∫ Telegram Stars –∏ –±—ç–∫–µ–Ω–¥—É.
    </p>
  </div>

  <!-- –¢–ê–ë–õ–ò–¶–ê -->
  <div id="table" class="screen">
    <h2>–¢–∞–±–ª–∏—Ü–∞</h2>
    <div class="table-wrapper">
      <table>
        <thead>
          <tr><th>–ú–µ—Å—Ç–æ</th><th>–ù–∏–∫</th><th>–û—á–∫–∏</th></tr>
        </thead>
        <tbody id="playersTable"></tbody>
      </table>
    </div>
  </div>

  <!-- –ü–†–û–ì–ù–û–ó–´ (–æ–±—ã—á–Ω–∞—è –ª–∏–≥–∞) -->
  <div id="predictions" class="screen">
    <h2>–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Ç—É—Ä</h2>
    <p>–í–≤–µ–¥–∏ —Å—á—ë—Ç—ã –º–∞—Ç—á–µ–π –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑¬ª</p>

    <div id="matchesList"></div>

    <button id="predictionsButton" onclick="submitPredictions()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑</button>
    <p id="predictionsResult"></p>

    <!-- –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –º–∞—Ç—á–µ–π -->
    <div id="adminMatchesPanel">
      <hr />
      <h3>–ê–¥–º–∏–Ω: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π –∏ –¥–µ–¥–ª–∞–π–Ω—ã</h3>
      <p class="notice">
        –ó–¥–µ—Å—å —Ç—ã –∑–∞–¥–∞—ë—à—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≤–∏–¥–∏—à—å –¥–µ–¥–ª–∞–π–Ω –ø–æ –∫–∞–∂–¥–æ–º—É –º–∞—Ç—á—É.<br />
        –í —ç—Ç–æ–π —Å—Ç–∞—Ç–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å—á—ë—Ç –∏–¥—ë—Ç –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞.
      </p>

      <div id="adminMatchesList"></div>
      <button onclick="adminSaveMatchResults()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π</button>
      <p id="adminMatchesStatus"></p>

      <hr />
      <h3>–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á –≤ —Ç—É—Ä</h3>
      <p>
        –î–æ–º–∞—à–Ω—è—è –∫–æ–º–∞–Ω–¥–∞:
        <input id="admNewHome" style="width:140px;">
        –ì–æ—Å—Ç–∏:
        <input id="admNewAway" style="width:140px;">
      </p>
      <p>
        –î–µ–¥–ª–∞–π–Ω (—Ñ–æ—Ä–º–∞—Ç <span class="notice">2025-11-30T21:00:00+03:00</span>):<br />
        <input id="admNewDeadline" style="width:260px;">
      </p>
      <button onclick="adminAddMatch()">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</button>
      <p id="adminAddMatchStatus"></p>
    </div>
  </div>

  <!-- –ü–†–û–§–ò–õ–¨ -->
  <div id="profile" class="screen">
    <h2>–¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
    <p>–ù–∏–∫: <b id="profileNick"></b></p>
    <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="profileClub">‚Äî</span></p>
    <p>–û—á–∫–∏: <span id="profilePoints">0</span></p>
    <p>–°—ã–≥—Ä–∞–Ω–æ —Ç—É—Ä–æ–≤: <span id="profileTours">0</span></p>
    <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤: <span id="profileAccuracy">0%</span></p>
    <p>–ë–∞–ª–∞–Ω—Å: <span id="profileStars">0</span> ‚≠ê</p>
    <p>–ë–∏–ª–µ—Ç—ã: <span id="profileTickets">0</span></p>
    <p><b>–ù–∞–≥—Ä–∞–¥—ã (–∞—á–∏–≤–∫–∏):</b></p>
    <div id="profileRewards"></div>
  </div>

  <!-- –ù–ê–ì–†–ê–î–´ -->
  <div id="prizes" class="screen">
    <h2>–ù–∞–≥—Ä–∞–¥—ã —Å–µ–∑–æ–Ω–∞</h2>
    <p><b>–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ–∑–æ–Ω –ª–∏–≥–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Å—Ç–æ–≤:</b></p>
    <p>ü•á 1 –º–µ—Å—Ç–æ ‚Äî —Ñ—É—Ç–±–æ–ª–∫–∞ –ª—é–±–∏–º–æ–≥–æ –∫–ª—É–±–∞</p>
    <p>ü•à 2 –º–µ—Å—Ç–æ ‚Äî –±–∏–ª–µ—Ç –Ω–∞ —Ñ—É—Ç–±–æ–ª –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ (–¥–æ 5 000 ‚ÇΩ)</p>
    <p>ü•â 3 –º–µ—Å—Ç–æ ‚Äî Telegram Premium –Ω–∞ 3 –º–µ—Å—è—Ü–∞</p>

    <hr />

    <h3>–ê—á–∏–≤–∫–∏ = –±–∏–ª–µ—Ç—ã –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à üéü</h3>
    <p class="notice">
      –ö–∞–∂–¥–∞—è –∞—á–∏–≤–∫–∞ –¥–∞—ë—Ç 1 –±–∏–ª–µ—Ç. –ß–µ–º –±–æ–ª—å—à–µ –±–∏–ª–µ—Ç–æ–≤ ‚Äî —Ç–µ–º –≤—ã—à–µ —à–∞–Ω—Å –∑–∞–±—Ä–∞—Ç—å –ø–æ–¥–∞—Ä–æ–∫ –≤ –∫–æ–Ω—Ü–µ —Å–µ–∑–æ–Ω–∞.
    </p>

    <ul style="text-align:left; max-width:420px; margin:0 auto;">
      <li><span class="highlight">100% –∏—Å—Ö–æ–¥–æ–≤ –≤ —Ç—É—Ä–µ</span> ‚Äî ¬´–ò–¥–µ–∞–ª—å–Ω—ã–π —Ç—É—Ä¬ª</li>
      <li><span class="highlight">3 —Ç–æ—á–Ω—ã—Ö —Å—á—ë—Ç–∞ –ø–æ–¥—Ä—è–¥</span> ‚Äî ¬´–°–Ω–∞–π–ø–µ—Ä¬ª</li>
      <li><span class="highlight">10 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤</span> ‚Äî ¬´–ñ–µ–ª–µ–∑–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫¬ª</li>
      <li><span class="highlight">50 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤</span> ‚Äî ¬´–õ–µ–≥–µ–Ω–¥–∞ –ª–∏–≥–∏¬ª</li>
      <li><span class="highlight">100 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤</span> ‚Äî ¬´–ë–µ—Å—Å–º–µ—Ä—Ç–Ω—ã–π¬ª</li>
      <li><span class="highlight">–ö–æ—Ä–æ–ª—å –∏—Å—Ö–æ–¥–æ–≤</span> ‚Äî –ª—É—á—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∏—Å—Ö–æ–¥–æ–≤ –ø–æ —Å–µ–∑–æ–Ω—É</li>
    </ul>
  </div>

  <!-- –ü–†–û–°–ú–û–¢–† –ü–†–û–§–ò–õ–Ø –ò–ì–†–û–ö–ê –ò–ó –¢–ê–ë–õ–ò–¶–´ -->
  <div id="playerModal" class="screen">
    <h2>–ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞</h2>
    <p>–ù–∏–∫: <span id="pmNick"></span></p>
    <p>–ú–µ—Å—Ç–æ: <span id="pmPlace"></span></p>
    <p>–û—á–∫–∏: <span id="pmPoints"></span></p>
    <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="pmClub"></span></p>
    <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤: <span id="pmAccuracy"></span>%</p>
    <p>–õ—É—á—à–∏–π —Ç—É—Ä: <span id="pmBestRound"></span></p>
    <button onclick="openScreen('table')">–ù–∞–∑–∞–¥ –∫ —Ç–∞–±–ª–∏—Ü–µ</button>
  </div>

  <!-- –¢–û–ß–ù–´–ô –£–î–ê–† -->
  <div id="strike" class="screen">
    <h2>üéØ –¢–æ—á–Ω—ã–π —É–¥–∞—Ä</h2>

    <p>–ë–∞–ª–∞–Ω—Å: <b><span id="strikeStars">0</span> ‚≠ê</b></p>

    <h3 id="strikeMatchTitle"></h3>
    <p id="strikeMatchTime"></p>

    <p>
      –¢–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑ —Å—á—ë—Ç–∞:
      <input type="number" id="strikeHome" min="0" placeholder="–î–æ–º" />
      :
      <input type="number" id="strikeAway" min="0" placeholder="–ì–æ—Å—Ç–∏" />
    </p>

    <p>
      –°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏ (‚≠ê):
      <input type="number" id="strikeBet" min="0" oninput="updateStrikePotential()" />
    </p>

    <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 10 ‚≠ê</p>

    <p>üí∞ –í—ã–∏–≥—Ä—ã—à –ø—Ä–∏ –∏—Å—Ö–æ–¥–µ: <b><span id="strikeOutcomeWin">0 ‚≠ê</span></b></p>
    <p>üéØ –í—ã–∏–≥—Ä—ã—à –ø—Ä–∏ —Ç–æ—á–Ω–æ–º —Å—á—ë—Ç–µ: <b><span id="strikeExactWin">0 ‚≠ê</span></b></p>

    <button onclick="makeStrikeBet()">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
    <p id="strikeStatus"></p>

    <h3>–¢–≤–æ—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–≤–∫–∞</h3>
    <p id="strikeLastInfo" class="notice">–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç–∞–≤–∫–∏.</p>

    <!-- –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ç–æ—á–Ω–æ–≥–æ —É–¥–∞—Ä–∞ -->
    <div id="adminStrikePanel">
      <hr />
      <h3>–ê–¥–º–∏–Ω: ¬´–¢–æ—á–Ω—ã–π —É–¥–∞—Ä¬ª</h3>
      <p class="notice">
        –ó–¥–µ—Å—å —Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å –º–∞—Ç—á, –¥–µ–¥–ª–∞–π–Ω –∏ —Å—á–∏—Ç–∞–µ—à—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–≤–∫—É.<br />
        –ü–æ–∑–∂–µ —ç—Ç–æ –ø–µ—Ä–µ–µ–¥–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –±—É–¥–µ—Ç –æ–±—â–∏–º –¥–ª—è –≤—Å–µ—Ö.
      </p>

      <h4>–ú–∞—Ç—á –∏ –¥–µ–¥–ª–∞–π–Ω</h4>
      <p>
        –î–æ–º:
        <input id="admStrikeHome" style="width:120px;">
        –ì–æ—Å—Ç–∏:
        <input id="admStrikeAway" style="width:120px;">
      </p>
      <p>
        –û–ø–∏—Å–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (–¥–ª—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ):<br />
        <input id="admStrikeTime" style="width:260px;">
      </p>
      <p>
        –î–µ–¥–ª–∞–π–Ω (—Ñ–æ—Ä–º–∞—Ç <span class="notice">2025-11-30T21:45:00+03:00</span>):<br />
        <input id="admStrikeDeadline" style="width:260px;">
      </p>
      <button onclick="adminSaveStrikeMatch()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ç—á</button>
      <p id="strikeMatchStatus"></p>

      <hr />
      <h4>–†–∞—Å—á—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞–≤–∫–∏</h4>
      <p>
        –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—á—ë—Ç:
        <input type="number" id="strikeRealHome" min="0" placeholder="–î–æ–º" />
        :
        <input type="number" id="strikeRealAway" min="0" placeholder="–ì–æ—Å—Ç–∏" />
      </p>
      <button onclick="settleLastStrikeBet()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–≤–∫—É</button>
      <p id="strikeSettleStatus"></p>
    </div>
  </div>

  <script>
    /*********************
     *  –ë–ê–ó–û–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
     *********************/
    const currentUserName = "bombardir17"; // –ø–æ–∑–∂–µ –ø–æ–¥–º–µ–Ω–∏–º –Ω–∞ username –∏–∑ Telegram
    const ADMIN_NICK = "bombardir17";
    const isAdmin = currentUserName === ADMIN_NICK;

    /*********************
     *  –ö–õ–Æ–ß–ò –•–†–ê–ù–ï–ù–ò–Ø
     *********************/
    const KEY_PREFIX = "lp_v7_";

    const KEY_CLUB = KEY_PREFIX + "favoriteClub";
    const KEY_STARS = KEY_PREFIX + "balanceStars";
    const KEY_TICKETS = KEY_PREFIX + "tickets";
    const KEY_USER_POINTS = KEY_PREFIX + "userPoints";
    const KEY_TOTAL_PREDS = KEY_PREFIX + "totalPredictions";
    const KEY_CORRECT_RES = KEY_PREFIX + "correctResults";
    const KEY_TOURS = KEY_PREFIX + "totalTours";
    const KEY_STRIKE_BETS = KEY_PREFIX + "strikeBets";
    const KEY_MATCHES = KEY_PREFIX + "matches";
    const KEY_REWARDS = KEY_PREFIX + "rewards";
    const KEY_STRIKE_MATCH = KEY_PREFIX + "strikeMatch";

    /*********************
     *  –°–û–°–¢–û–Ø–ù–ò–ï
     *********************/
    let favoriteClub = localStorage.getItem(KEY_CLUB) || null;
    let balanceStars = parseInt(localStorage.getItem(KEY_STARS) || "100", 10);
    let tickets = parseInt(localStorage.getItem(KEY_TICKETS) || "0", 10);
    let userPoints = parseInt(localStorage.getItem(KEY_USER_POINTS) || "27", 10);
    let totalPredictions = parseInt(localStorage.getItem(KEY_TOTAL_PREDS) || "0", 10);
    let correctResults = parseInt(localStorage.getItem(KEY_CORRECT_RES) || "0", 10);
    let totalTours = parseInt(localStorage.getItem(KEY_TOURS) || "0", 10);
    let strikeBets = JSON.parse(localStorage.getItem(KEY_STRIKE_BETS) || "[]");
    let rewards = JSON.parse(localStorage.getItem(KEY_REWARDS) || "[]");

    /*********************
     *  –ú–ê–¢–ß–ò –õ–ò–ì–ò
     *********************/
    const defaultMatches = [
      {
        id: 1,
        home: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
        away: "–û–ª–∏–º–ø–∏–∞–∫–æ—Å",
        deadline: "2025-11-26T11:00:00+03:00",
        realHome: null,
        realAway: null
      },
      {
        id: 2,
        home: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        away: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏",
        deadline: "2025-11-27T21:00:00+03:00",
        realHome: null,
        realAway: null
      },
      {
        id: 3,
        home: "–ü–°–ñ",
        away: "–ë–∞–≤–∞—Ä–∏—è",
        deadline: "2025-11-28T21:00:00+03:00",
        realHome: null,
        realAway: null
      }
    ];

    let matches = [];

    function loadMatches() {
      const saved = localStorage.getItem(KEY_MATCHES);
      if (saved) {
        try {
          const parsed = JSON.parse(saved);
          if (Array.isArray(parsed) && parsed.length) {
            matches = parsed;
            return;
          }
        } catch (e) {}
      }
      matches = defaultMatches.map(m => ({ ...m }));
    }

    function saveMatches() {
      localStorage.setItem(KEY_MATCHES, JSON.stringify(matches));
    }

    /*********************
     *  –ú–ê–¢–ß ¬´–¢–û–ß–ù–û–ì–û –£–î–ê–†–ê¬ª
     *********************/
    let strikeMatch =
      JSON.parse(localStorage.getItem(KEY_STRIKE_MATCH) || "null") || {
        home: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        away: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
        time: "–°–µ–≥–æ–¥–Ω—è, 21:45 (–ú–°–ö)",
        deadline: "2025-11-26T21:40:00+03:00"
      };

    /*********************
     *  –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï
     *********************/
    function saveAll() {
      localStorage.setItem(KEY_CLUB, favoriteClub || "");
      localStorage.setItem(KEY_STARS, String(balanceStars));
      localStorage.setItem(KEY_TICKETS, String(tickets));
      localStorage.setItem(KEY_USER_POINTS, String(userPoints));
      localStorage.setItem(KEY_TOTAL_PREDS, String(totalPredictions));
      localStorage.setItem(KEY_CORRECT_RES, String(correctResults));
      localStorage.setItem(KEY_TOURS, String(totalTours));
      localStorage.setItem(KEY_STRIKE_BETS, JSON.stringify(strikeBets));
      localStorage.setItem(KEY_REWARDS, JSON.stringify(rewards));
      localStorage.setItem(KEY_STRIKE_MATCH, JSON.stringify(strikeMatch));
      saveMatches();
    }

    function openScreen(id) {
      document.querySelectorAll(".screen").forEach(s => (s.style.display = "none"));
      const el = document.getElementById(id);
      if (el) el.style.display = "block";

      // –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
      document.querySelectorAll(".menu button").forEach(btn => btn.classList.remove("active"));
      const btnMap = {
        home: 0,
        table: 1,
        predictions: 2,
        profile: 3,
        prizes: 4,
        strike: 5
      };
      const idx = btnMap[id];
      if (idx !== undefined) {
        const menuBtns = document.querySelectorAll(".menu button");
        if (menuBtns[idx]) menuBtns[idx].classList.add("active");
      }
    }

    function updateBalancesUI() {
      document.getElementById("homeStars").innerText = balanceStars;
      document.getElementById("profileStars").innerText = balanceStars;
      document.getElementById("strikeStars").innerText = balanceStars;
    }

    function updateClubUI() {
      const c = favoriteClub || "–Ω–µ –≤—ã–±—Ä–∞–Ω";
      document.getElementById("homeClub").innerText = c;
      document.getElementById("profileClub").innerText = c;
    }

    function updateTicketsUI() {
      document.getElementById("homeTickets").innerText = tickets;
      document.getElementById("profileTickets").innerText = tickets;
    }

    function updatePointsAndStatsUI() {
      document.getElementById("homePoints").innerText = userPoints;
      document.getElementById("profilePoints").innerText = userPoints;
      document.getElementById("profileTours").innerText = totalTours;
      const acc =
        totalPredictions > 0
          ? Math.round((correctResults / totalPredictions) * 100)
          : 0;
      document.getElementById("profileAccuracy").innerText = acc + "%";
    }

    function updateRewardsUI() {
      const container = document.getElementById("profileRewards");
      container.innerHTML = "";
      if (!rewards.length) {
        container.innerHTML = "<p>–ü–æ–∫–∞ –Ω–µ—Ç –∞—á–∏–≤–æ–∫.</p>";
        return;
      }
      rewards.forEach(r => {
        const div = document.createElement("div");
        div.className = "tag";
        div.innerText = r;
        container.appendChild(div);
      });
    }

    function addReward(name) {
      if (!rewards.includes(name)) {
        rewards.push(name);
        tickets += 1; // –∫–∞–∂–¥–∞—è –Ω–æ–≤–∞—è –∞—á–∏–≤–∫–∞ = 1 –±–∏–ª–µ—Ç
      }
    }

    function initStrikeMatchUI() {
      document.getElementById("strikeMatchTitle").innerText =
        strikeMatch.home + " ‚Äî " + strikeMatch.away;

      let text = "–í—Ä–µ–º—è –º–∞—Ç—á–∞: " + (strikeMatch.time || "-");
      if (strikeMatch.deadline) {
        const dl = new Date(strikeMatch.deadline).toLocaleString("ru-RU");
        text += " | –î–µ–¥–ª–∞–π–Ω –ø—Ä–∏—ë–º–∞ —Å—Ç–∞–≤–æ–∫: " + dl;
      }
      document.getElementById("strikeMatchTime").innerText = text;
    }

    function isStrikeClosed() {
      if (!strikeMatch.deadline) return false;
      return new Date() > new Date(strikeMatch.deadline);
    }

    /*********************
     *  –í–´–ë–û–† –ö–õ–£–ë–ê
     *********************/
    let tempSelectedClub = null;

    function selectClub(elem, clubName) {
      document
        .querySelectorAll(".club-btn")
        .forEach(c => c.classList.remove("club-selected"));
      elem.classList.add("club-selected");
      tempSelectedClub = clubName;
      document.getElementById("clubConfirm").disabled = false;
    }

    document.getElementById("clubConfirm").onclick = function () {
      if (!tempSelectedClub) return;
      favoriteClub = tempSelectedClub;
      saveAll();
      updateClubUI();
      document.getElementById("clubSelect").style.display = "none";
      openScreen("home");
      rebuildTable();
    };

    /*********************
     *  –¢–ê–ë–õ–ò–¶–ê
     *********************/
    const playersBase = [
      {
        name: "bombardir17",
        points: userPoints,
        club: favoriteClub || "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        accuracy: 67,
        bestRound: "3 —Ç—É—Ä"
      },
      {
        name: "kinggoals",
        points: 18,
        club: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
        accuracy: 42,
        bestRound: "1 —Ç—É—Ä"
      },
      {
        name: "footlord",
        points: 13,
        club: "–ü–°–ñ",
        accuracy: 31,
        bestRound: "2 —Ç—É—Ä"
      },
      {
        name: "predator",
        points: 7,
        club: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏",
        accuracy: 21,
        bestRound: "1 —Ç—É—Ä"
      },
      {
        name: "goalstorm",
        points: 5,
        club: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        accuracy: 10,
        bestRound: "-"
      },
      {
        name: "xg_master",
        points: 4,
        club: "–ü–°–ñ",
        accuracy: 9,
        bestRound: "-"
      },
      {
        name: "clean_sheet",
        points: 3,
        club: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
        accuracy: 5,
        bestRound: "-"
      },
      {
        name: "pressinggod",
        points: 2,
        club: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏",
        accuracy: 4,
        bestRound: "-"
      },
      {
        name: "hat_trick",
        points: 1,
        club: "–ò–Ω—Ç–µ—Ä –ú–∞–π–∞–º–∏",
        accuracy: 3,
        bestRound: "-"
      },
      {
        name: "latewinner",
        points: 0,
        club: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        accuracy: 0,
        bestRound: "-"
      }
    ];

    function getPlayersForTable() {
      const copy = playersBase.map(p => ({ ...p }));
      const me = copy.find(p => p.name === currentUserName);
      if (me) {
        me.points = userPoints;
        if (favoriteClub) me.club = favoriteClub;
        const acc =
          totalPredictions > 0
            ? Math.round((correctResults / totalPredictions) * 100)
            : me.accuracy;
        me.accuracy = acc;
      }
      copy.sort((a, b) => b.points - a.points);
      return copy;
    }

    function rebuildTable() {
      const tbody = document.getElementById("playersTable");
      tbody.innerHTML = "";
      const players = getPlayersForTable();
      players.forEach((p, index) => {
        const tr = document.createElement("tr");
        const place = index + 1;
        tr.innerHTML = `
          <td>${place}</td>
          <td><span class="nick" onclick="openPlayer('${p.name}')">${p.name}</span></td>
          <td>${p.points}</td>
        `;
        tbody.appendChild(tr);
        if (p.name === currentUserName) {
          document.getElementById("homePlace").innerText = place;
        }
      });
    }

    function openPlayer(nick) {
      const players = getPlayersForTable();
      const idx = players.findIndex(p => p.name === nick);
      if (idx === -1) return;
      const p = players[idx];
      document.getElementById("pmNick").innerText = p.name;
      document.getElementById("pmPlace").innerText = idx + 1;
      document.getElementById("pmPoints").innerText = p.points;
      document.getElementById("pmClub").innerText = p.club || "-";
      document.getElementById("pmAccuracy").innerText = p.accuracy ?? 0;
      document.getElementById("pmBestRound").innerText = p.bestRound || "-";
      openScreen("playerModal");
    }
    window.openPlayer = openPlayer;

    /*********************
     *  –ü–†–û–ì–ù–û–ó–´ –õ–ò–ì–ò
     *********************/
    function isMatchClosed(m) {
      if (!m.deadline) return false;
      return new Date() > new Date(m.deadline);
    }

    function buildMatchesUI() {
      const container = document.getElementById("matchesList");
      container.innerHTML = "";

      matches.forEach(m => {
        const closed = isMatchClosed(m);
        const dlText = m.deadline
          ? new Date(m.deadline).toLocaleString("ru-RU")
          : "–±–µ–∑ –¥–µ–¥–ª–∞–π–Ω–∞";

        const row = document.createElement("div");
        row.className = "match-row";
        if (closed) {
          row.innerHTML = `
            <div>
              <b>${m.home} ‚Äî ${m.away}</b> <br/>
              <span class="closed">–ü—Ä–∏—ë–º –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –∑–∞–∫—Ä—ã—Ç</span><br/>
              <span class="notice">–î–µ–¥–ª–∞–π–Ω: ${dlText}</span>
            </div>
          `;
        } else {
          row.innerHTML = `
            <div>
              <b>${m.home}</b>
              <input type="number" id="pred-home-${m.id}" min="0" style="width:50px;">
              :
              <input type="number" id="pred-away-${m.id}" min="0" style="width:50px;">
              <b>${m.away}</b><br/>
              <span class="notice">–î–µ–¥–ª–∞–π–Ω: ${dlText}</span>
            </div>
          `;
        }
        container.appendChild(row);
      });
    }

    function buildAdminMatchesUI() {
      const container = document.getElementById("adminMatchesList");
      container.innerHTML = "";
      matches.forEach(m => {
        const dlText = m.deadline
          ? new Date(m.deadline).toLocaleString("ru-RU")
          : "‚Äî";
        const row = document.createElement("div");
        row.className = "match-row";
        row.innerHTML = `
          <div>
            <b>${m.home} ‚Äî ${m.away}</b><br/>
            –†–µ–∞–ª—å–Ω—ã–π —Å—á—ë—Ç:
            <input type="number" id="adm-real-home-${m.id}" min="0" style="width:45px;" value="${m.realHome ?? ""}">
            :
            <input type="number" id="adm-real-away-${m.id}" min="0" style="width:45px;" value="${m.realAway ?? ""}">
            <br/>
            <span class="notice">–î–µ–¥–ª–∞–π–Ω: ${dlText}</span>
          </div>
        `;
        container.appendChild(row);
      });
    }

    function adminSaveMatchResults() {
      if (!isAdmin) return;
      matches.forEach(m => {
        const hInput = document.getElementById(`adm-real-home-${m.id}`);
        const aInput = document.getElementById(`adm-real-away-${m.id}`);
        if (!hInput || !aInput) return;
        const h = hInput.value === "" ? null : parseInt(hInput.value, 10);
        const a = aInput.value === "" ? null : parseInt(aInput.value, 10);
        m.realHome = h;
        m.realAway = a;
      });
      saveAll();
      document.getElementById("adminMatchesStatus").innerText =
        "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–ª–æ–∫–∞–ª—å–Ω–æ).";
    }
    window.adminSaveMatchResults = adminSaveMatchResults;

    function adminAddMatch() {
      if (!isAdmin) return;
      const home = document.getElementById("admNewHome").value.trim();
      const away = document.getElementById("admNewAway").value.trim();
      const deadline = document.getElementById("admNewDeadline").value.trim();
      const status = document.getElementById("adminAddMatchStatus");

      if (!home || !away) {
        status.innerText = "–ó–∞–ø–æ–ª–Ω–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥.";
        return;
      }
      if (!deadline) {
        status.innerText = "–í–≤–µ–¥–∏ –¥–µ–¥–ª–∞–π–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ 2025-11-30T21:00:00+03:00.";
        return;
      }
      if (isNaN(new Date(deadline).getTime())) {
        status.innerText = "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä–æ–∫—É.";
        return;
      }

      const maxId = matches.reduce((max, m) => Math.max(max, m.id), 0);
      const newMatch = {
        id: maxId + 1,
        home,
        away,
        deadline,
        realHome: null,
        realAway: null
      };
      matches.push(newMatch);
      saveAll();
      buildMatchesUI();
      buildAdminMatchesUI();

      document.getElementById("admNewHome").value = "";
      document.getElementById("admNewAway").value = "";
      document.getElementById("admNewDeadline").value = "";
      status.innerText = "–ú–∞—Ç—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç—É—Ä.";
    }
    window.adminAddMatch = adminAddMatch;

    let predictionsSent = false;

    function submitPredictions() {
      if (predictionsSent) {
        document.getElementById("predictionsResult").innerText =
          "–¢—ã —É–∂–µ –æ—Ç–ø—Ä–∞–≤–∏–ª –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —ç—Ç–æ—Ç —Ç—É—Ä (–¥–µ–º–æ).";
        return;
      }

      let gainedPoints = 0;
      let tourPredictions = 0;
      let tourCorrect = 0;
      const fav = favoriteClub;

      matches.forEach(m => {
        const closed = isMatchClosed(m);
        if (closed) return;

        const hInput = document.getElementById(`pred-home-${m.id}`);
        const aInput = document.getElementById(`pred-away-${m.id}`);
        if (!hInput || !aInput) return;

        const hStr = hInput.value;
        const aStr = aInput.value;
        if (hStr === "" || aStr === "") return;

        const ph = parseInt(hStr, 10);
        const pa = parseInt(aStr, 10);

        if (m.realHome == null || m.realAway == null) {
          return;
        }

        tourPredictions++;
        totalPredictions++;

        let pts = 0;

        if (ph === m.realHome && pa === m.realAway) {
          pts = 3;
          tourCorrect++;
          correctResults++;
        } else {
          const realDiff = m.realHome - m.realAway;
          const predDiff = ph - pa;
          const realRes = realDiff === 0 ? 0 : realDiff > 0 ? 1 : -1;
          const predRes = predDiff === 0 ? 0 : predDiff > 0 ? 1 : -1;
          if (realRes === predRes) {
            pts = 1;
            tourCorrect++;
            correctResults++;
          }
        }

        if (fav && (m.home === fav || m.away === fav)) {
          pts *= 2; // –º–∞—Ç—á–∏ –ª—é–±–∏–º–æ–≥–æ –∫–ª—É–±–∞ √ó2
        }

        gainedPoints += pts;
      });

      if (tourPredictions === 0) {
        document.getElementById("predictionsResult").innerText =
          "–õ–∏–±–æ —Ç—É—Ä –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–¥–º–∏–Ω–æ–º, –ª–∏–±–æ —Ç—ã –Ω–µ –≤–≤—ë–ª –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å—á—ë—Ç–∞.";
        return;
      }

      userPoints += gainedPoints;
      totalTours++;

      const accTour = Math.round((tourCorrect / tourPredictions) * 100);
      if (accTour === 100) addReward("–ò–¥–µ–∞–ª—å–Ω—ã–π —Ç—É—Ä");
      if (totalTours === 10) addReward("10 —Ç—É—Ä–æ–≤");
      if (totalTours === 50) addReward("50 —Ç—É—Ä–æ–≤");
      if (totalTours === 100) addReward("100 —Ç—É—Ä–æ–≤");

      predictionsSent = true;
      document.getElementById("predictionsButton").disabled = true;
      document.getElementById(
        "predictionsResult"
      ).innerText = `–¢—É—Ä —Å—ã–≥—Ä–∞–Ω. –¢—ã –Ω–∞–±—Ä–∞–ª ${gainedPoints} –æ—á–∫–æ–≤ –∑–∞ —ç—Ç–æ—Ç —Ç—É—Ä (–¥–µ–º–æ).`;

      saveAll();
      updatePointsAndStatsUI();
      updateTicketsUI();
      updateRewardsUI();
      rebuildTable();
    }
    window.submitPredictions = submitPredictions;

    /*********************
     *  –¢–û–ß–ù–´–ô –£–î–ê–†
     *********************/
    function getLastStrike() {
      if (!strikeBets.length) return null;
      return strikeBets[strikeBets.length - 1];
    }

    function updateStrikeLastInfo() {
      const el = document.getElementById("strikeLastInfo");
      if (!el) return;
      const last = getLastStrike();
      if (!last) {
        el.innerText = "–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç–∞–≤–∫–∏.";
        return;
      }
      el.innerText =
        "–ú–∞—Ç—á: " +
        last.match +
        ", –ø—Ä–æ–≥–Ω–æ–∑: " +
        last.home +
        ":" +
        last.away +
        ", —Å—Ç–∞–≤–∫–∞: " +
        last.bet +
        " ‚≠ê";
    }

    function updateStrikePotential() {
      const betStr = document.getElementById("strikeBet").value;
      const bet = parseFloat(betStr || "0");
      if (bet <= 0) {
        document.getElementById("strikeOutcomeWin").innerText = "0 ‚≠ê";
        document.getElementById("strikeExactWin").innerText = "0 ‚≠ê";
        return;
      }
      const winOutcome = Math.floor(bet * 1.95);
      const winExact = Math.floor(bet * 4.8);
      document.getElementById("strikeOutcomeWin").innerText = winOutcome + " ‚≠ê";
      document.getElementById("strikeExactWin").innerText = winExact + " ‚≠ê";
    }
    window.updateStrikePotential = updateStrikePotential;

    function makeStrikeBet() {
      const homeStr = document.getElementById("strikeHome").value;
      const awayStr = document.getElementById("strikeAway").value;
      const betStr = document.getElementById("strikeBet").value;
      const status = document.getElementById("strikeStatus");

      if (isStrikeClosed()) {
        status.innerText = "–ü—Ä–∏—ë–º —Å—Ç–∞–≤–æ–∫ –ø–æ —ç—Ç–æ–º—É –º–∞—Ç—á—É –∑–∞–∫—Ä—ã—Ç.";
        return;
      }

      const home = parseInt(homeStr || "-1", 10);
      const away = parseInt(awayStr || "-1", 10);
      const bet = parseFloat(betStr || "0");

      if (isNaN(home) || isNaN(away) || home < 0 || away < 0) {
        status.innerText = "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –ø—Ä–æ–≥–Ω–æ–∑ —Å—á—ë—Ç–∞.";
        return;
      }

      const minBet = 10;
      if (bet < minBet) {
        status.innerText = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 10 ‚≠ê";
        return;
      }

      if (bet > balanceStars) {
        status.innerText =
          "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥. –ë–∞–ª–∞–Ω—Å: " + balanceStars + " ‚≠ê";
        return;
      }

      balanceStars -= bet;

      strikeBets.push({
        match: strikeMatch.home + " ‚Äî " + strikeMatch.away,
        home,
        away,
        bet,
        time: new Date().toISOString()
      });

      status.innerText = "‚úÖ –°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. –ñ–¥—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞.";
      document.getElementById("strikeBet").value = "";
      document.getElementById("strikeHome").value = "";
      document.getElementById("strikeAway").value = "";
      document.getElementById("strikeOutcomeWin").innerText = "0 ‚≠ê";
      document.getElementById("strikeExactWin").innerText = "0 ‚≠ê";

      saveAll();
      updateBalancesUI();
      updateStrikeLastInfo();
    }
    window.makeStrikeBet = makeStrikeBet;

    function settleLastStrikeBet() {
      const status = document.getElementById("strikeSettleStatus");
      const rhStr = document.getElementById("strikeRealHome").value;
      const raStr = document.getElementById("strikeRealAway").value;

      if (!isAdmin) {
        status.innerText = "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É.";
        return;
      }

      if (strikeBets.length === 0) {
        status.innerText = "–ù–µ—Ç —Å—Ç–∞–≤–æ–∫ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞.";
        return;
      }
      if (rhStr === "" || raStr === "") {
        status.innerText = "–í–≤–µ–¥–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—á—ë—Ç –º–∞—Ç—á–∞.";
        return;
      }

      const realHome = parseInt(rhStr, 10);
      const realAway = parseInt(raStr, 10);

      const bet = strikeBets[strikeBets.length - 1];
      const betHome = bet.home;
      const betAway = bet.away;
      const amount = bet.bet;

      const realDiff = realHome - realAway;
      const betDiff = betHome - betAway;
      const realRes = realDiff === 0 ? 0 : realDiff > 0 ? 1 : -1;
      const betRes = betDiff === 0 ? 0 : betDiff > 0 ? 1 : -1;

      let win = 0;
      let type = "–ø—Ä–æ–∏–≥—Ä—ã—à";

      if (betHome === realHome && betAway === realAway) {
        win = Math.floor(amount * 4.8);
        type = "–¢–û–ß–ù–´–ô –°–ß–Å–¢";
      } else if (betRes === realRes) {
        win = Math.floor(amount * 1.95);
        type = "–∏—Å—Ö–æ–¥";
      }

      if (win > 0) {
        balanceStars += win;
        tickets += 1; // –∑–∞ –≤—ã–∏–≥—Ä–∞–Ω–Ω—ã–π —Ç–æ—á–Ω—ã–π —É–¥–∞—Ä ‚Äî –±–∏–ª–µ—Ç
        status.innerText = `‚úÖ –°—Ç–∞–≤–∫–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞: ${type}. –í—ã–∏–≥—Ä—ã—à +${win} ‚≠ê`;
      } else {
        status.innerText = "‚ùå –°—Ç–∞–≤–∫–∞ –Ω–µ —Å—ã–≥—Ä–∞–ª–∞. –í—ã–∏–≥—Ä—ã—à–∞ –Ω–µ—Ç.";
      }

      strikeBets.pop();
      saveAll();
      updateBalancesUI();
      updateTicketsUI();
      updateRewardsUI();
      updateStrikeLastInfo();
    }
    window.settleLastStrikeBet = settleLastStrikeBet;

    /*********************
     *  –ê–î–ú–ò–ù: –ú–ê–¢–ß –¢–û–ß–ù–û–ì–û –£–î–ê–†–ê
     *********************/
    function adminSaveStrikeMatch() {
      if (!isAdmin) return;
      const h = document.getElementById("admStrikeHome").value.trim();
      const a = document.getElementById("admStrikeAway").value.trim();
      const t = document.getElementById("admStrikeTime").value.trim();
      const d = document.getElementById("admStrikeDeadline").value.trim();
      const s = document.getElementById("strikeMatchStatus");

      if (!h || !a) {
        s.innerText = "–ó–∞–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—ã (–¥–æ–º/–≥–æ—Å—Ç–∏).";
        return;
      }
      if (!d) {
        s.innerText = "–í–≤–µ–¥–∏ –¥–µ–¥–ª–∞–π–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ 2025-11-30T21:45:00+03:00.";
        return;
      }
      if (isNaN(new Date(d).getTime())) {
        s.innerText = "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–µ–¥–ª–∞–π–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä–æ–∫—É.";
        return;
      }

      strikeMatch.home = h;
      strikeMatch.away = a;
      strikeMatch.time = t || strikeMatch.time;
      strikeMatch.deadline = d;

      saveAll();
      initStrikeMatchUI();
      s.innerText = "–ú–∞—Ç—á –¥–ª—è ¬´–¢–æ—á–Ω–æ–≥–æ —É–¥–∞—Ä–∞¬ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω.";
    }
    window.adminSaveStrikeMatch = adminSaveStrikeMatch;

    /*********************
     *  –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
     *********************/
    document.addEventListener("DOMContentLoaded", function () {
      loadMatches();
      initStrikeMatchUI();

      document.getElementById("profileNick").innerText = currentUserName;

      updateBalancesUI();
      updateClubUI();
      updateTicketsUI();
      updatePointsAndStatsUI();
      updateRewardsUI();

      buildMatchesUI();
      rebuildTable();

      if (isAdmin) {
        const adminPanel = document.getElementById("adminStrikePanel");
        if (adminPanel) adminPanel.style.display = "block";
        const admMatches = document.getElementById("adminMatchesPanel");
        if (admMatches) admMatches.style.display = "block";
        buildAdminMatchesUI();

        // –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—è –º–∞—Ç—á–∞ —Ç–æ—á–Ω–æ–≥–æ —É–¥–∞—Ä–∞
        document.getElementById("admStrikeHome").value = strikeMatch.home;
        document.getElementById("admStrikeAway").value = strikeMatch.away;
        document.getElementById("admStrikeTime").value = strikeMatch.time;
        document.getElementById("admStrikeDeadline").value =
          strikeMatch.deadline || "";
      } else {
        const adminPanel = document.getElementById("adminStrikePanel");
        if (adminPanel) adminPanel.style.display = "none";
        const admMatches = document.getElementById("adminMatchesPanel");
        if (admMatches) admMatches.style.display = "none";
      }

      if (favoriteClub) {
        document.getElementById("clubSelect").style.display = "none";
        openScreen("home");
      } else {
        document.getElementById("clubSelect").style.display = "block";
      }

      updateStrikeLastInfo();
    });
  </script>
</body>
</html>
