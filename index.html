<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–õ–∏–≥–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Å—Ç–æ–≤</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0b0c10;
      color: #f5f5f5;
      text-align: center;
      margin: 0;
      padding: 15px;
    }

    h1 {
      margin-bottom: 10px;
    }

    .menu {
      margin-bottom: 10px;
    }

    .menu button {
      background: #45f3ff;
      border: none;
      padding: 8px 12px;
      border-radius: 7px;
      margin: 4px;
      cursor: pointer;
      font-size: 14px;
      color: #000;
    }

    .menu button:hover {
      filter: brightness(1.05);
    }

    .screen {
      display: none;
      margin-top: 10px;
      background: #1f2833;
      padding: 15px;
      border-radius: 10px;
    }

    .club-btn {
      background: #243447;
      padding: 12px;
      margin: 5px auto;
      border-radius: 10px;
      max-width: 260px;
      cursor: pointer;
      border: 1px solid #2e3b4e;
    }

    .club-btn:hover {
      background: #2d3b4d;
    }

    .club-selected {
      border: 2px solid #45f3ff;
      background: #16202a;
    }

    button {
      border: none;
      padding: 7px 12px;
      border-radius: 7px;
      cursor: pointer;
      margin-top: 5px;
    }

    input,
    select {
      padding: 5px;
      border-radius: 5px;
      border: none;
      margin: 3px;
    }

    input[type="number"] {
      width: 70px;
      text-align: center;
    }

    .table-wrapper {
      max-height: 260px;
      overflow-y: auto;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px solid #2e3b4e;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th,
    td {
      border-bottom: 1px solid #34495e;
      padding: 6px;
    }

    th {
      font-weight: bold;
      position: sticky;
      top: 0;
      background: #1f2833;
    }

    .nick {
      color: #45f3ff;
      cursor: pointer;
    }

    .nick:hover {
      text-decoration: underline;
    }

    .note {
      font-size: 12px;
      opacity: 0.8;
    }

    .badge {
      display: inline-block;
      padding: 4px 7px;
      border-radius: 8px;
      background: #16202a;
      margin: 3px;
      font-size: 13px;
    }

    .badge span {
      opacity: 0.8;
    }

    hr {
      border: none;
      border-top: 1px solid #34495e;
      margin: 15px 0;
    }

    .admin-block-title {
      margin-top: 5px;
      margin-bottom: 10px;
    }

    .match-row {
      margin: 6px 0;
    }

    .match-closed {
      color: #ff7675;
      font-size: 13px;
    }

    .match-deadline {
      font-size: 12px;
      opacity: 0.8;
    }

    /* –∞–¥–º–∏–Ω—Å–∫–∏–µ –±–ª–æ–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç—ã */
    .admin-block {
      display: none;
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px dashed #455a64;
      text-align: left;
      font-size: 14px;
    }

    .admin-block h3 {
      text-align: center;
    }

    .admin-section-label {
      font-weight: bold;
      margin-top: 10px;
      margin-bottom: 5px;
    }

    #adminToggleWrapper {
      margin-top: 20px;
      text-align: right;
      font-size: 12px;
      opacity: 0.5;
    }

    #adminToggleWrapper button {
      background: #111;
      color: #fff;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
    }

    #adminToggleWrapper button:hover {
      filter: brightness(1.1);
    }
  </style>
</head>
<body>
<h1>‚öΩ –õ–∏–≥–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Å—Ç–æ–≤</h1>

<div class="menu">
  <button onclick="openScreen('home')">–ì–ª–∞–≤–Ω–∞—è</button>
  <button onclick="openScreen('table')">–¢–∞–±–ª–∏—Ü–∞</button>
  <button onclick="openScreen('predictions')">–ü—Ä–æ–≥–Ω–æ–∑</button>
  <button onclick="openScreen('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
  <button onclick="openScreen('rewards')">–ù–∞–≥—Ä–∞–¥—ã</button>
  <button onclick="openScreen('strike')">üéØ –¢–æ—á–Ω—ã–π —É–¥–∞—Ä</button>
</div>

<!-- –í–´–ë–û–† –ö–õ–£–ë–ê -->
<div id="clubSelect">
  <h3>–í—ã–±–µ—Ä–∏ –ª—é–±–∏–º—ã–π –∫–ª—É–± (1 —Ä–∞–∑ –∑–∞ —Å–µ–∑–æ–Ω)</h3>
  <div class="club-btn" onclick="selectClub(this, '–ë–∞—Ä—Å–µ–ª–æ–Ω–∞')">üîµüî¥ –ë–∞—Ä—Å–µ–ª–æ–Ω–∞</div>
  <div class="club-btn" onclick="selectClub(this, '–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥')">‚ö™ –†–µ–∞–ª –ú–∞–¥—Ä–∏–¥</div>
  <div class="club-btn" onclick="selectClub(this, '–ë–∞–≤–∞—Ä–∏—è')">üî¥ –ë–∞–≤–∞—Ä–∏—è</div>
  <div class="club-btn" onclick="selectClub(this, '–ê—Ä—Å–µ–Ω–∞–ª')">üî¥ –ê—Ä—Å–µ–Ω–∞–ª</div>
  <div class="club-btn" onclick="selectClub(this, '–õ–∏–≤–µ—Ä–ø—É–ª—å')">üî¥ –õ–∏–≤–µ—Ä–ø—É–ª—å</div>
  <div class="club-btn" onclick="selectClub(this, '–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥')">üî¥ –ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥</div>
  <div class="club-btn" onclick="selectClub(this, '–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏')">üî∑ –ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏</div>
  <div class="club-btn" onclick="selectClub(this, '–ü–°–ñ')">üîµüî¥ –ü–°–ñ</div>
  <button id="clubConfirm" disabled onclick="confirmClub()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–±–æ—Ä</button>
</div>

<!-- –ì–õ–ê–í–ù–ê–Ø -->
<div id="home" class="screen">
  <h2>–ì–ª–∞–≤–Ω–∞—è</h2>
  <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="homeClub">‚Äî</span></p>
  <p>–¢–≤–æ–∏ –æ—á–∫–∏: <span id="homePoints">0</span></p>
  <p>–¢–≤–æ—ë –º–µ—Å—Ç–æ: <span id="homePlace">‚Äî</span></p>
  <p>–ë–∞–ª–∞–Ω—Å: <span id="homeStars">0</span> ‚≠ê</p>
  <p>–ë–∏–ª–µ—Ç—ã –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à: <span id="homeTickets">0</span></p>
</div>

<!-- –¢–ê–ë–õ–ò–¶–ê -->
<div id="table" class="screen">
  <h2>–¢–∞–±–ª–∏—Ü–∞</h2>
  <div class="table-wrapper">
    <table>
      <thead>
      <tr><th>–ú–µ—Å—Ç–æ</th><th>–ù–∏–∫</th><th>–û—á–∫–∏</th></tr>
      </thead>
      <tbody id="playersTable"></tbody>
    </table>
  </div>
</div>

<!-- –ü–†–û–ì–ù–û–ó–´ -->
<div id="predictions" class="screen">
  <h2>–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Ç—É—Ä</h2>
  <p>–í–≤–µ–¥–∏ —Å—á—ë—Ç—ã –º–∞—Ç—á–µ–π –∏ –Ω–∞–∂–º–∏ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑¬ª</p>
  <div id="matchesList"></div>
  <button onclick="submitPredictions()" id="predictionsButton">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑</button>
  <p id="predictionsResult"></p>

  <!-- –ê–î–ú–ò–ù: –ú–ê–¢–ß–ò –¢–£–†–ê –ò –†–ï–ó–£–õ–¨–¢–ê–¢–´ -->
  <div class="admin-block" id="adminLeagueBlock">
    <h3 class="admin-block-title">–ê–¥–º–∏–Ω: –º–∞—Ç—á–∏ —Ç—É—Ä–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
    <p class="note">
      –ó–¥–µ—Å—å —Ç—ã –∑–∞–¥–∞—ë—à—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—ã –∏ –¥–µ–¥–ª–∞–π–Ω—ã. –í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –≤—Å—ë —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è (MVP).
    </p>

    <div id="adminMatchesResults"></div>

    <button onclick="adminSaveResultsAndCalc()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç—É—Ä</button>
    <p id="adminLeagueStatus"></p>

    <hr>

    <div>
      <div class="admin-section-label">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á –≤ —Ç—É—Ä</div>
      <p>
        –î–æ–º–∞—à–Ω—è—è –∫–æ–º–∞–Ω–¥–∞:
        <input type="text" id="adminAddHome" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –†–µ–∞–ª –ú–∞–¥—Ä–∏–¥">
      </p>
      <p>
        –ì–æ—Å—Ç–∏:
        <input type="text" id="adminAddAway" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –ë–∞—Ä—Å–µ–ª–æ–Ω–∞">
      </p>
      <p>
        –î–µ–¥–ª–∞–π–Ω (—Ñ–æ—Ä–º–∞—Ç 2025-11-30T21:45:00+03:00):
        <input type="text" id="adminAddDeadline" style="width:240px;">
      </p>
      <button onclick="adminAddMatch()">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</button>
      <p class="note">–ù–æ–≤—ã–π –º–∞—Ç—á —Å—Ä–∞–∑—É –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–ª—è –≤—Å–µ—Ö.</p>
    </div>
  </div>
</div>

<!-- –ü–†–û–§–ò–õ–¨ -->
<div id="profile" class="screen">
  <h2>–¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
  <p>–ù–∏–∫: <b>bombardir17</b></p>
  <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="profileClub">‚Äî</span></p>
  <p>–û—á–∫–∏: <span id="profilePoints">0</span></p>
  <p>–°—ã–≥—Ä–∞–Ω–æ —Ç—É—Ä–æ–≤: <span id="profileTours">0</span></p>
  <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤: <span id="profileAccuracy">0%</span></p>
  <p>–õ—É—á—à–∏–π —Ç—É—Ä: <span id="profileBestRound">–ø–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span></p>
  <p>–ë–∞–ª–∞–Ω—Å: <span id="profileStars">0</span> ‚≠ê</p>
  <p>–ë–∏–ª–µ—Ç—ã: <span id="profileTickets">0</span></p>

  <h3>–¢–≤–æ–∏ –Ω–∞–≥—Ä–∞–¥—ã</h3>
  <div id="profileRewardsList">
    –ü–æ–∫–∞ –Ω–µ—Ç –Ω–∞–≥—Ä–∞–¥ ‚Äî –≤—Å—ë –≤–ø–µ—Ä–µ–¥–∏! üí™
  </div>
</div>

<!-- –ù–ê–ì–†–ê–î–´ -->
<div id="rewards" class="screen">
  <h2>–ù–∞–≥—Ä–∞–¥—ã –∏ –ø—Ä–∏–∑—ã</h2>

  <h3>–ü—Ä–∏–∑—ã –ø–æ –∏—Ç–æ–≥–∞–º —Å–µ–∑–æ–Ω–∞</h3>
  <p class="badge">ü•á 1 –º–µ—Å—Ç–æ ‚Äî —Ñ—É—Ç–±–æ–ª–∫–∞ –ª—é–±–∏–º–æ–≥–æ –∫–ª—É–±–∞</p><br>
  <p class="badge">ü•à 2 –º–µ—Å—Ç–æ ‚Äî –±–∏–ª–µ—Ç –Ω–∞ —Ñ—É—Ç–±–æ–ª –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ (–¥–æ 5 000 ‚ÇΩ)</p><br>
  <p class="badge">ü•â 3 –º–µ—Å—Ç–æ ‚Äî Telegram Premium –Ω–∞ 3 –º–µ—Å—è—Ü–∞</p>

  <hr>

  <h3>–ù–∞–≥—Ä–∞–¥—ã –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–∞</h3>
  <div>
    <div class="badge">üéØ 3 —Ç–æ—á–Ω—ã—Ö —Å—á—ë—Ç–∞ –ø–æ–¥—Ä—è–¥ <span>+ –±–∏–ª–µ—Ç</span></div>
    <div class="badge">‚úÖ –ò–¥–µ–∞–ª—å–Ω—ã–π —Ç—É—Ä –ø–æ –∏—Å—Ö–æ–¥–∞–º (100%) <span>+ –±–∏–ª–µ—Ç</span></div>
    <div class="badge">üìÖ 10 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤ <span>+ –±–∏–ª–µ—Ç</span></div>
    <div class="badge">üìÖ 50 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤ <span>+ 3 –±–∏–ª–µ—Ç–∞</span></div>
    <div class="badge">üìÖ 100 —Å—ã–≥—Ä–∞–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤ <span>+ 5 –±–∏–ª–µ—Ç–æ–≤</span></div>
    <div class="badge">üëë –ö–æ—Ä–æ–ª—å –∏—Å—Ö–æ–¥–æ–≤ (70%+ –∑–∞ —Å–µ–∑–æ–Ω) <span>+ 5 –±–∏–ª–µ—Ç–æ–≤</span></div>
  </div>

  <hr>

  <h3>–¢–≤–æ–∏ –±–∏–ª–µ—Ç—ã</h3>
  <p>–í—Å–µ–≥–æ –±–∏–ª–µ—Ç–æ–≤: <b><span id="rewardsTickets">0</span></b></p>
  <p class="note">–ö–∞–∂–¥—ã–π –±–∏–ª–µ—Ç ‚Äî —à–∞–Ω—Å –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à –ø—Ä–∏–∑–æ–≤ –ø–æ—Å–ª–µ —Å–µ–∑–æ–Ω–∞.</p>
</div>

<!-- –ü–†–û–§–ò–õ–¨ –ò–ì–†–û–ö–ê –ò–ó –¢–ê–ë–õ–ò–¶–´ -->
<div id="playerModal" class="screen">
  <h2>–ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞</h2>
  <p>–ù–∏–∫: <span id="pmNick"></span></p>
  <p>–ú–µ—Å—Ç–æ: <span id="pmPlace"></span></p>
  <p>–û—á–∫–∏: <span id="pmPoints"></span></p>
  <p>–õ—é–±–∏–º—ã–π –∫–ª—É–±: <span id="pmClub"></span></p>
  <p>–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤: <span id="pmAccuracy"></span>%</p>
  <p>–õ—É—á—à–∏–π —Ç—É—Ä: <span id="pmBestRound"></span></p>
  <button onclick="openScreen('table')">–ù–∞–∑–∞–¥ –∫ —Ç–∞–±–ª–∏—Ü–µ</button>
</div>

<!-- –¢–û–ß–ù–´–ô –£–î–ê–† -->
<div id="strike" class="screen">
  <h2>üéØ –¢–æ—á–Ω—ã–π —É–¥–∞—Ä</h2>

  <p>–ë–∞–ª–∞–Ω—Å: <span id="strikeStars">0</span> ‚≠ê</p>

  <h3 id="strikeMatchTitle"></h3>
  <p id="strikeMatchTime"></p>
  <p id="strikeMatchDeadlineText" class="match-deadline"></p>

  <div id="strikeClosedMsg" class="match-closed" style="display:none;">
    –ü—Ä–∏—ë–º —Å—Ç–∞–≤–æ–∫ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –∑–∞–∫—Ä—ã—Ç.
  </div>

  <div id="strikeInputsBlock">
    <p>
      –¢–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑ —Å—á—ë—Ç–∞:
      <input type="number" id="strikeHome" min="0" placeholder="–î–æ–º">
      :
      <input type="number" id="strikeAway" min="0" placeholder="–ì–æ—Å—Ç–∏">
    </p>

    <p>
      –°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏ (‚≠ê):
      <input type="number" id="strikeBet" min="0" oninput="updateStrikePotential()">
    </p>

    <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 10 ‚≠ê</p>

    <p>üí∞ –í—ã–∏–≥—Ä—ã—à –ø—Ä–∏ –∏—Å—Ö–æ–¥–µ: <b><span id="strikeOutcomeWin">0 ‚≠ê</span></b></p>
    <p>üéØ –í—ã–∏–≥—Ä—ã—à –ø—Ä–∏ —Ç–æ—á–Ω–æ–º —Å—á—ë—Ç–µ: <b><span id="strikeExactWin">0 ‚≠ê</span></b></p>

    <button onclick="makeStrikeBet()">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
    <p id="strikeStatus"></p>
  </div>

  <hr>

  <h3>–¢–≤–æ—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–≤–∫–∞</h3>
  <p id="lastStrikeInfo">–ü–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫.</p>

  <!-- –ê–î–ú–ò–ù: –¢–û–ß–ù–´–ô –£–î–ê–† -->
  <div class="admin-block" id="adminStrikeBlock">
    <h3>–ê–¥–º–∏–Ω: ¬´–¢–æ—á–Ω—ã–π —É–¥–∞—Ä¬ª</h3>
    <p class="note">
      –ó–¥–µ—Å—å —Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å –º–∞—Ç—á, –¥–µ–¥–ª–∞–π–Ω –∏ —Å—á–∏—Ç–∞–µ—à—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–≤–∫—É.
    </p>

    <div class="admin-section-label">–ú–∞—Ç—á –∏ –¥–µ–¥–ª–∞–π–Ω</div>
    <p>
      –î–æ–º:
      <input type="text" id="adminStrikeHome" style="width:160px;">
      –ì–æ—Å—Ç–∏:
      <input type="text" id="adminStrikeAway" style="width:160px;">
    </p>
    <p>
      –û–ø–∏—Å–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (—Ç–µ–∫—Å—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ):<br>
      <input type="text" id="adminStrikeTimeText" style="width:260px;">
    </p>
    <p>
      –î–µ–¥–ª–∞–π–Ω (—Ñ–æ—Ä–º–∞—Ç 2025-11-30T21:45:00+03:00):<br>
      <input type="text" id="adminStrikeDeadline" style="width:260px;">
    </p>
    <button onclick="adminSaveStrikeMatch()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ç—á</button>

    <hr>

    <div class="admin-section-label">–†–∞—Å—á—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç–∞–≤–∫–∏</div>
    <p>
      –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—á—ë—Ç:
      <input type="number" id="strikeRealHome" min="0" placeholder="–î–æ–º">
      :
      <input type="number" id="strikeRealAway" min="0" placeholder="–ì–æ—Å—Ç–∏">
    </p>
    <button onclick="settleLastStrikeBet()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–≤–∫—É</button>
    <p id="strikeSettleStatus"></p>
  </div>
</div>

<!-- –ö–ù–û–ü–ö–ê –ê–î–ú–ò–ù–ê -->
<div id="adminToggleWrapper">
  <button onclick="toggleAdmin()">üîí –ê–¥–º–∏–Ω</button>
</div>

<script>
  const currentUserName = "bombardir17";

  // ============= –ù–ê–°–¢–†–û–ô–ö–ò –ê–î–ú–ò–ù–ê =============
  const ADMIN_PASSWORD = "0235"; // –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
  const KEY_IS_ADMIN = "lp_v4_isAdmin";

  let isAdmin = localStorage.getItem(KEY_IS_ADMIN) === "1";

  // ============= –ö–õ–Æ–ß–ò =============
  const KEY_CLUB          = "lp_v4_favoriteClub";
  const KEY_STARS         = "lp_v4_balanceStars";
  const KEY_TICKETS       = "lp_v4_tickets";
  const KEY_USER_POINTS   = "lp_v4_userPoints";
  const KEY_TOTAL_PREDS   = "lp_v4_totalPredictions";
  const KEY_CORRECT_RES   = "lp_v4_correctResults";
  const KEY_TOURS         = "lp_v4_totalTours";
  const KEY_MATCHES       = "lp_v4_matches";
  const KEY_TOUR_PREDS    = "lp_v4_tourPredictions";
  const KEY_TOUR_SENT     = "lp_v4_tourSent";
  const KEY_LAST_STRIKE   = "lp_v4_lastStrikeBet";
  const KEY_STRIKE_MATCH  = "lp_v4_strikeMatch";

  // ============= –°–û–°–¢–û–Ø–ù–ò–ï =============
  let favoriteClub = localStorage.getItem(KEY_CLUB) || null;
  let balanceStars = parseInt(localStorage.getItem(KEY_STARS) || "0", 10);
  let tickets      = parseInt(localStorage.getItem(KEY_TICKETS) || "0", 10);
  let userPoints   = parseInt(localStorage.getItem(KEY_USER_POINTS) || "27", 10);
  let totalPredictions = parseInt(localStorage.getItem(KEY_TOTAL_PREDS) || "0", 10);
  let correctResults   = parseInt(localStorage.getItem(KEY_CORRECT_RES) || "0", 10);
  let totalTours       = parseInt(localStorage.getItem(KEY_TOURS) || "0", 10);

  // –î–ª—è "–ª—É—á—à–µ–≥–æ —Ç—É—Ä–∞" –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏–º –º–∞–∫—Å–∏–º—É–º –æ—á–∫–æ–≤ –∑–∞ —Ç—É—Ä
  let bestTourPoints = parseInt(localStorage.getItem("lp_v4_bestTourPoints") || "0", 10);

  // –ú–∞—Ç—á–∏ —Ç—É—Ä–∞
  let matches = JSON.parse(localStorage.getItem(KEY_MATCHES) || "null");
  if (!matches) {
    // —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –¥–µ–º–æ-–Ω–∞–±–æ—Ä
    matches = [
      {
        id: 1,
        home: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
        away: "–û–ª–∏–º–ø–∏–∞–∫–æ—Å",
        deadline: "2025-11-26T11:00:00+03:00",
        realHome: null,
        realAway: null
      },
      {
        id: 2,
        home: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
        away: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏",
        deadline: "2025-11-27T21:00:00+03:00",
        realHome: null,
        realAway: null
      },
      {
        id: 3,
        home: "–ü–°–ñ",
        away: "–ë–∞–≤–∞—Ä–∏—è",
        deadline: "2025-11-28T21:00:00+03:00",
        realHome: null,
        realAway: null
      }
    ];
    localStorage.setItem(KEY_MATCHES, JSON.stringify(matches));
  }

  // –ü—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ —Ç–µ–∫—É—â–∏–π —Ç—É—Ä (—Ö—Ä–∞–Ω—è—Ç—Å—è –¥–æ —Ä–∞—Å—á—ë—Ç–∞)
  let savedTourPredictions =
    JSON.parse(localStorage.getItem(KEY_TOUR_PREDS) || "[]");
  let tourSent = localStorage.getItem(KEY_TOUR_SENT) === "1";

  // –ú–∞—Ç—á –¥–ª—è "—Ç–æ—á–Ω–æ–≥–æ —É–¥–∞—Ä–∞"
  let strikeMatch = JSON.parse(localStorage.getItem(KEY_STRIKE_MATCH) || "null");
  if (!strikeMatch) {
    strikeMatch = {
      home: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
      away: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥",
      timeText: "–°–µ–≥–æ–¥–Ω—è, 21:45 (–ú–°–ö)",
      deadline: "2025-11-26T21:30:00+03:00"
    };
    localStorage.setItem(KEY_STRIKE_MATCH, JSON.stringify(strikeMatch));
  }

  let lastStrikeBet = JSON.parse(localStorage.getItem(KEY_LAST_STRIKE) || "null");

  // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
  const playersBase = [
    { name: "bombardir17", points: userPoints, club: favoriteClub || "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞", accuracy: 67, bestRound: "3 —Ç—É—Ä" },
    { name: "kinggoals",   points: 18, club: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥", accuracy: 42, bestRound: "1 —Ç—É—Ä" },
    { name: "footlord",    points: 13, club: "–ü–°–ñ", accuracy: 31, bestRound: "2 —Ç—É—Ä" },
    { name: "predator",    points: 7,  club: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏", accuracy: 21, bestRound: "1 —Ç—É—Ä" },
    { name: "goalstorm",   points: 5,  club: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞", accuracy: 10, bestRound: "-" },
    { name: "xg_master",   points: 4,  club: "–ü–°–ñ", accuracy: 9, bestRound: "-" },
    { name: "clean_sheet", points: 3,  club: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥", accuracy: 5, bestRound: "-" },
    { name: "pressinggod", points: 2,  club: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏", accuracy: 4, bestRound: "-" },
    { name: "hat_trick",   points: 1,  club: "–ò–Ω—Ç–µ—Ä –ú–∞–π–∞–º–∏", accuracy: 3, bestRound: "-" },
    { name: "latewinner",  points: 0,  club: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞", accuracy: 0, bestRound: "-" }
  ];

  // =============== –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò ===============
  function saveAll() {
    localStorage.setItem(KEY_CLUB, favoriteClub || "");
    localStorage.setItem(KEY_STARS, String(balanceStars));
    localStorage.setItem(KEY_TICKETS, String(tickets));
    localStorage.setItem(KEY_USER_POINTS, String(userPoints));
    localStorage.setItem(KEY_TOTAL_PREDS, String(totalPredictions));
    localStorage.setItem(KEY_CORRECT_RES, String(correctResults));
    localStorage.setItem(KEY_TOURS, String(totalTours));
    localStorage.setItem("lp_v4_bestTourPoints", String(bestTourPoints));
    localStorage.setItem(KEY_MATCHES, JSON.stringify(matches));
    localStorage.setItem(KEY_TOUR_PREDS, JSON.stringify(savedTourPredictions));
    localStorage.setItem(KEY_TOUR_SENT, tourSent ? "1" : "0");
    localStorage.setItem(KEY_STRIKE_MATCH, JSON.stringify(strikeMatch));
    if (lastStrikeBet) {
      localStorage.setItem(KEY_LAST_STRIKE, JSON.stringify(lastStrikeBet));
    }
  }

  function openScreen(id) {
    document.querySelectorAll(".screen").forEach(s => s.style.display = "none");
    document.getElementById(id).style.display = "block";
  }

  function updateBalancesUI() {
    document.getElementById("homeStars").innerText = balanceStars;
    document.getElementById("profileStars").innerText = balanceStars;
    document.getElementById("strikeStars").innerText = balanceStars;
  }

  function updateClubUI() {
    const c = favoriteClub || "–Ω–µ –≤—ã–±—Ä–∞–Ω";
    document.getElementById("homeClub").innerText    = c;
    document.getElementById("profileClub").innerText = c;
  }

  function updateTicketsUI() {
    document.getElementById("homeTickets").innerText    = tickets;
    document.getElementById("profileTickets").innerText = tickets;
    document.getElementById("rewardsTickets").innerText = tickets;
  }

  function updatePointsAndStatsUI() {
    document.getElementById("homePoints").innerText    = userPoints;
    document.getElementById("profilePoints").innerText = userPoints;
    document.getElementById("profileTours").innerText  = totalTours;

    const acc = totalPredictions > 0
      ? Math.round((correctResults / totalPredictions) * 100)
      : 0;
    document.getElementById("profileAccuracy").innerText = acc + "%";

    if (bestTourPoints > 0) {
      document.getElementById("profileBestRound").innerText =
        bestTourPoints + " –æ—á–∫–æ–≤ ‚Äî –ª—É—á—à–∏–π —Ç—É—Ä";
    }

    rebuildRewardsList(acc);
  }

  // =============== –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ ===============
  function applyAdminVisibility() {
    document.querySelectorAll(".admin-block").forEach(el => {
      el.style.display = isAdmin ? "block" : "none";
    });
  }

  function toggleAdmin() {
    if (isAdmin) {
      // –≤—ã–∫–ª—é—á–∏—Ç—å –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º
      isAdmin = false;
      localStorage.removeItem(KEY_IS_ADMIN);
      applyAdminVisibility();
      alert("–ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –≤—ã–∫–ª—é—á–µ–Ω.");
      return;
    }

    const pwd = prompt("–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω-–ø–∞—Ä–æ–ª—å:");
    if (pwd === ADMIN_PASSWORD) {
      isAdmin = true;
      localStorage.setItem(KEY_IS_ADMIN, "1");
      applyAdminVisibility();
      alert("–ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –≤–∫–ª—é—á—ë–Ω.");
    } else if (pwd !== null) {
      alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.");
    }
  }

  // =============== –í–´–ë–û–† –ö–õ–£–ë–ê ===============
  let tempSelectedClub = null;

  function selectClub(elem, clubName) {
    document.querySelectorAll(".club-btn").forEach(c => c.classList.remove("club-selected"));
    elem.classList.add("club-selected");
    tempSelectedClub = clubName;
    document.getElementById("clubConfirm").disabled = false;
  }

  function confirmClub() {
    if (!tempSelectedClub) return;
    favoriteClub = tempSelectedClub;
    saveAll();
    updateClubUI();
    rebuildTable();
    document.getElementById("clubSelect").style.display = "none";
    openScreen("home");
  }

  // =============== –¢–ê–ë–õ–ò–¶–ê ===============
  function getPlayersForTable() {
    const copy = playersBase.map(p => ({ ...p }));
    const me = copy.find(p => p.name === currentUserName);
    if (me) {
      me.points = userPoints;
      if (favoriteClub) me.club = favoriteClub;
      const acc = totalPredictions > 0
        ? Math.round((correctResults / totalPredictions) * 100)
        : me.accuracy;
      me.accuracy = acc;
      if (bestTourPoints > 0) {
        me.bestRound = bestTourPoints + " –æ—á–∫–æ–≤";
      }
    }
    copy.sort((a, b) => b.points - a.points);
    return copy;
  }

  function rebuildTable() {
    const tbody = document.getElementById("playersTable");
    tbody.innerHTML = "";
    const players = getPlayersForTable();

    players.forEach((p, index) => {
      const tr = document.createElement("tr");
      const place = index + 1;
      tr.innerHTML = `
        <td>${place}</td>
        <td><span class="nick" onclick="openPlayer('${p.name}')">${p.name}</span></td>
        <td>${p.points}</td>
      `;
      tbody.appendChild(tr);

      if (p.name === currentUserName) {
        document.getElementById("homePlace").innerText = place;
      }
    });
  }

  function openPlayer(nick) {
    const players = getPlayersForTable();
    const idx = players.findIndex(p => p.name === nick);
    if (idx === -1) return;
    const p = players[idx];

    document.getElementById("pmNick").innerText = p.name;
    document.getElementById("pmPlace").innerText = idx + 1;
    document.getElementById("pmPoints").innerText = p.points;
    document.getElementById("pmClub").innerText = p.club || "-";
    document.getElementById("pmAccuracy").innerText = p.accuracy ?? 0;
    document.getElementById("pmBestRound").innerText = p.bestRound || "-";

    openScreen("playerModal");
  }

  // =============== –ü–†–û–ì–ù–û–ó–´ –ù–ê –¢–£–† ===============
  function buildMatchesUserUI() {
    const container = document.getElementById("matchesList");
    container.innerHTML = "";

    const now = new Date();

    matches.forEach(m => {
      const deadline = m.deadline ? new Date(m.deadline) : null;
      const closed = deadline && now > deadline;

      const row = document.createElement("div");
      row.className = "match-row";

      const pred = savedTourPredictions.find(p => p.id === m.id);

      const homeVal = pred ? pred.home : "";
      const awayVal = pred ? pred.away : "";

      row.innerHTML = `
        <div>
          <b>${m.home} ‚Äî ${m.away}</b>
        </div>
        <div style="margin:4px 0;">
          ${
            closed
              ? `<span class="match-closed">–ü—Ä–∏—ë–º –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –∑–∞–∫—Ä—ã—Ç</span>`
              : `
            <input type="number" id="pred-home-${m.id}" min="0" style="width:50px;" value="${homeVal}">
            :
            <input type="number" id="pred-away-${m.id}" min="0" style="width:50px;" value="${awayVal}">
          `
          }
        </div>
        <div class="match-deadline">
          –î–µ–¥–ª–∞–π–Ω: ${m.deadline || "–Ω–µ –∑–∞–¥–∞–Ω"}
        </div>
      `;
      container.appendChild(row);
    });
  }

  function buildMatchesAdminResultsUI() {
    const container = document.getElementById("adminMatchesResults");
    if (!container) return;

    container.innerHTML = "";

    matches.forEach(m => {
      const block = document.createElement("div");
      block.style.marginBottom = "10px";
      block.innerHTML = `
        <div class="admin-section-label">${m.home} ‚Äî ${m.away}</div>
        <div>–†–µ–∞–ª—å–Ω—ã–π —Å—á—ë—Ç:
          <input type="number" id="admin-real-home-${m.id}" min="0" style="width:50px;" value="${m.realHome ?? ""}">
          :
          <input type="number" id="admin-real-away-${m.id}" min="0" style="width:50px;" value="${m.realAway ?? ""}">
        </div>
        <div class="match-deadline">
          –î–µ–¥–ª–∞–π–Ω: 
          <input type="text" id="admin-deadline-${m.id}" style="width:220px;" value="${m.deadline || ""}">
        </div>
        <hr>
      `;
      container.appendChild(block);
    });
  }

  function submitPredictions() {
    const now = new Date();
    let anyEntered = false;
    const newPreds = [];

    matches.forEach(m => {
      const deadline = m.deadline ? new Date(m.deadline) : null;
      const closed = deadline && now > deadline;

      if (closed) return;

      const homeInput = document.getElementById(`pred-home-${m.id}`);
      const awayInput = document.getElementById(`pred-away-${m.id}`);
      if (!homeInput || !awayInput) return;

      const hStr = homeInput.value;
      const aStr = awayInput.value;
      if (hStr === "" || aStr === "") return;

      anyEntered = true;
      newPreds.push({
        id: m.id,
        home: parseInt(hStr, 10),
        away: parseInt(aStr, 10)
      });
    });

    if (!anyEntered) {
      document.getElementById("predictionsResult").innerText =
        "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –ø—Ä–æ–≥–Ω–æ–∑ —Ö–æ—Ç—è –±—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –º–∞—Ç—á–∞ (–∏ –Ω–µ –ø–æ—Å–ª–µ –¥–µ–¥–ª–∞–π–Ω–∞).";
      return;
    }

    savedTourPredictions = newPreds;
    tourSent = true;
    saveAll();

    document.getElementById("predictionsButton").disabled = true;
    document.getElementById("predictionsResult").innerText =
      "–ü—Ä–æ–≥–Ω–æ–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω! –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–µ–π –∏ —Ä–∞—Å—á—ë—Ç–∞ —Ç—É—Ä–∞.";
  }

  function adminSaveResultsAndCalc() {
    const status = document.getElementById("adminLeagueStatus");
    if (!isAdmin) {
      status.innerText = "–ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞.";
      return;
    }

    // –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ —Å—á—ë—Ç—ã –∏ –¥–µ–¥–ª–∞–π–Ω—ã
    matches.forEach(m => {
      const rh = document.getElementById(`admin-real-home-${m.id}`);
      const ra = document.getElementById(`admin-real-away-${m.id}`);
      const dl = document.getElementById(`admin-deadline-${m.id}`);

      if (rh && ra) {
        const h = rh.value === "" ? null : parseInt(rh.value, 10);
        const a = ra.value === "" ? null : parseInt(ra.value, 10);
        m.realHome = isNaN(h) ? null : h;
        m.realAway = isNaN(a) ? null : a;
      }
      if (dl) {
        m.deadline = dl.value || null;
      }
    });

    if (!savedTourPredictions.length) {
      saveAll();
      buildMatchesUserUI();
      status.innerText = "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –Ω–æ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ —ç—Ç–æ—Ç —Ç—É—Ä –ø–æ–∫–∞ –Ω–µ—Ç.";
      return;
    }

    // —Ä–∞—Å—á—ë—Ç –æ—á–∫–æ–≤
    let gainedPoints = 0;
    let tourPredictions = 0;
    let tourCorrectResults = 0;
    const fav = favoriteClub;

    savedTourPredictions.forEach(p => {
      const m = matches.find(mm => mm.id === p.id);
      if (!m || m.realHome == null || m.realAway == null) return;

      tourPredictions++;
      totalPredictions++;

      let pts = 0;

      if (p.home === m.realHome && p.away === m.realAway) {
        pts = 3;
        tourCorrectResults++;
        correctResults++;
      } else {
        const realDiff = m.realHome - m.realAway;
        const predDiff = p.home - p.away;
        const realRes = realDiff === 0 ? 0 : (realDiff > 0 ? 1 : -1);
        const predRes = predDiff === 0 ? 0 : (predDiff > 0 ? 1 : -1);
        if (realRes === predRes) {
          pts = 1;
          tourCorrectResults++;
          correctResults++;
        }
      }

      if (fav && (m.home === fav || m.away === fav)) {
        pts *= 2;
      }

      gainedPoints += pts;
    });

    if (tourPredictions === 0) {
      saveAll();
      buildMatchesUserUI();
      updatePointsAndStatsUI();
      status.innerText =
        "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –Ω–æ –ø–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º –ø—Ä–æ–≥–Ω–æ–∑–∞–º —Ä–∞—Å—á—ë—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω (–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—á—ë—Ç–æ–≤).";
      return;
    }

    userPoints += gainedPoints;
    totalTours++;
    tickets += 1; // –∑–∞ —Ç—É—Ä ‚Äî 1 –±–∏–ª–µ—Ç

    if (gainedPoints > bestTourPoints) {
      bestTourPoints = gainedPoints;
    }

    // –æ—á–∏—Å—Ç–∏–º –ø—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ —Ç—É—Ä (—Å–ª–µ–¥—É—é—â–∏–π —Ç—É—Ä ‚Äî –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä)
    savedTourPredictions = [];
    tourSent = false;

    saveAll();
    buildMatchesUserUI();
    buildMatchesAdminResultsUI();
    rebuildTable();
    updatePointsAndStatsUI();
    updateTicketsUI();

    document.getElementById("predictionsButton").disabled = false;
    document.getElementById("predictionsResult").innerText =
      "–¢—É—Ä —Ä–∞—Å—Å—á–∏—Ç–∞–Ω. –¢—ã –Ω–∞–±—Ä–∞–ª " + gainedPoints + " –æ—á–∫–æ–≤.";

    status.innerText = "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ç—á–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ —Ç—É—Ä —Ä–∞—Å—Å—á–∏—Ç–∞–Ω.";
  }

  function adminAddMatch() {
    if (!isAdmin) return;
    const home = document.getElementById("adminAddHome").value.trim();
    const away = document.getElementById("adminAddAway").value.trim();
    const dl   = document.getElementById("adminAddDeadline").value.trim();

    if (!home || !away || !dl) {
      alert("–ó–∞–ø–æ–ª–Ω–∏ –¥–æ–º, –≥–æ—Å—Ç–µ–π –∏ –¥–µ–¥–ª–∞–π–Ω.");
      return;
    }

    const newId = matches.length ? Math.max(...matches.map(m => m.id)) + 1 : 1;
    matches.push({
      id: newId,
      home,
      away,
      deadline: dl,
      realHome: null,
      realAway: null
    });

    saveAll();
    buildMatchesUserUI();
    buildMatchesAdminResultsUI();

    document.getElementById("adminAddHome").value = "";
    document.getElementById("adminAddAway").value = "";
    document.getElementById("adminAddDeadline").value = "";

    alert("–ú–∞—Ç—á –¥–æ–±–∞–≤–ª–µ–Ω.");
  }

  // =============== –ù–ê–ì–†–ê–î–´ (–ª–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è) ===============
  function rebuildRewardsList(accPercent) {
    const container = document.getElementById("profileRewardsList");
    const rewards = [];

    if (bestTourPoints >= 10) {
      rewards.push("üéØ –û—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π —Ç—É—Ä: " + bestTourPoints + " –æ—á–∫–æ–≤.");
    }
    if (totalTours >= 10) {
      rewards.push("üìÖ –°—ã–≥—Ä–∞–Ω–æ 10+ —Ç—É—Ä–æ–≤.");
    }
    if (totalTours >= 50) {
      rewards.push("üìÖ –°—ã–≥—Ä–∞–Ω–æ 50+ —Ç—É—Ä–æ–≤.");
    }
    if (totalTours >= 100) {
      rewards.push("üìÖ –°—ã–≥—Ä–∞–Ω–æ 100+ —Ç—É—Ä–æ–≤.");
    }
    if (accPercent >= 70 && totalPredictions >= 30) {
      rewards.push("üëë –ö–æ—Ä–æ–ª—å –∏—Å—Ö–æ–¥–æ–≤: —Ç–æ—á–Ω–æ—Å—Ç—å 70%+.");
    }

    if (!rewards.length) {
      container.innerHTML = "–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∞–≥—Ä–∞–¥ ‚Äî –≤—Å—ë –≤–ø–µ—Ä–µ–¥–∏! üí™";
      return;
    }

    container.innerHTML = "";
    rewards.forEach(text => {
      const p = document.createElement("p");
      p.textContent = text;
      container.appendChild(p);
    });
  }

  // =============== –¢–û–ß–ù–´–ô –£–î–ê–† ===============
  function initStrikeMatchUI() {
    document.getElementById("strikeMatchTitle").innerText =
      strikeMatch.home + " ‚Äî " + strikeMatch.away;
    document.getElementById("strikeMatchTime").innerText =
      strikeMatch.timeText;
    document.getElementById("strikeMatchDeadlineText").innerText =
      "–î–µ–¥–ª–∞–π–Ω –¥–ª—è —Å—Ç–∞–≤–æ–∫: " + strikeMatch.deadline;

    const now = new Date();
    const dl = strikeMatch.deadline ? new Date(strikeMatch.deadline) : null;
    const closed = dl && now > dl;

    document.getElementById("strikeClosedMsg").style.display =
      closed ? "block" : "none";
    document.getElementById("strikeInputsBlock").style.display =
      closed ? "none" : "block";

    if (lastStrikeBet) {
      updateLastStrikeInfo();
    } else {
      document.getElementById("lastStrikeInfo").innerText = "–ü–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫.";
    }
  }

  function updateStrikePotential() {
    const betStr = document.getElementById("strikeBet").value;
    const bet = parseFloat(betStr || "0");
    if (bet <= 0) {
      document.getElementById("strikeOutcomeWin").innerText = "0 ‚≠ê";
      document.getElementById("strikeExactWin").innerText   = "0 ‚≠ê";
      return;
    }

    const winOutcome = Math.floor(bet * 1.95);
    const winExact   = Math.floor(bet * 4.8);

    document.getElementById("strikeOutcomeWin").innerText = winOutcome + " ‚≠ê";
    document.getElementById("strikeExactWin").innerText   = winExact   + " ‚≠ê";
  }

  function makeStrikeBet() {
    const status = document.getElementById("strikeStatus");

    const now = new Date();
    const dl = strikeMatch.deadline ? new Date(strikeMatch.deadline) : null;
    if (dl && now > dl) {
      status.innerText = "–î–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à—ë–ª. –ü—Ä–∏—ë–º —Å—Ç–∞–≤–æ–∫ –∑–∞–∫—Ä—ã—Ç.";
      return;
    }

    const homeStr = document.getElementById("strikeHome").value;
    const awayStr = document.getElementById("strikeAway").value;
    const betStr  = document.getElementById("strikeBet").value;

    const home = parseInt(homeStr || "-1", 10);
    const away = parseInt(awayStr || "-1", 10);
    const bet  = parseFloat(betStr || "0");

    if (isNaN(home) || isNaN(away) || home < 0 || away < 0) {
      status.innerText = "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –ø—Ä–æ–≥–Ω–æ–∑ —Å—á—ë—Ç–∞.";
      return;
    }

    if (bet < 10) {
      status.innerText = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 10 ‚≠ê";
      return;
    }

    if (bet > balanceStars) {
      status.innerText = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥. –ë–∞–ª–∞–Ω—Å: " + balanceStars + " ‚≠ê";
      return;
    }

    balanceStars -= bet;

    lastStrikeBet = {
      match: strikeMatch.home + " ‚Äî " + strikeMatch.away,
      home,
      away,
      bet,
      time: new Date().toISOString()
    };

    status.innerText = "‚úÖ –°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. –ñ–¥—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞.";

    document.getElementById("strikeBet").value   = "";
    document.getElementById("strikeHome").value  = "";
    document.getElementById("strikeAway").value  = "";
    document.getElementById("strikeOutcomeWin").innerText = "0 ‚≠ê";
    document.getElementById("strikeExactWin").innerText   = "0 ‚≠ê";

    updateLastStrikeInfo();
    saveAll();
    updateBalancesUI();
  }

  function updateLastStrikeInfo() {
    if (!lastStrikeBet) {
      document.getElementById("lastStrikeInfo").innerText = "–ü–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫.";
      return;
    }
    document.getElementById("lastStrikeInfo").innerText =
      `–ú–∞—Ç—á: ${lastStrikeBet.match}, –ø—Ä–æ–≥–Ω–æ–∑: ${lastStrikeBet.home}:${lastStrikeBet.away}, —Å—Ç–∞–≤–∫–∞: ${lastStrikeBet.bet} ‚≠ê`;
  }

  function settleLastStrikeBet() {
    const status = document.getElementById("strikeSettleStatus");
    if (!isAdmin) {
      status.innerText = "–ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞.";
      return;
    }

    if (!lastStrikeBet) {
      status.innerText = "–ù–µ—Ç —Å—Ç–∞–≤–æ–∫ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞.";
      return;
    }

    const realHomeStr = document.getElementById("strikeRealHome").value;
    const realAwayStr = document.getElementById("strikeRealAway").value;

    if (realHomeStr === "" || realAwayStr === "") {
      status.innerText = "–í–≤–µ–¥–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å—á—ë—Ç.";
      return;
    }

    const realHome = parseInt(realHomeStr, 10);
    const realAway = parseInt(realAwayStr, 10);

    const betHome = lastStrikeBet.home;
    const betAway = lastStrikeBet.away;
    const amount  = lastStrikeBet.bet;

    const realDiff = realHome - realAway;
    const betDiff  = betHome - betAway;
    const realRes = realDiff === 0 ? 0 : (realDiff > 0 ? 1 : -1);
    const betRes  = betDiff === 0 ? 0 : (betDiff > 0 ? 1 : -1);

    let win = 0;
    let type = "–ø—Ä–æ–∏–≥—Ä—ã—à";

    if (betHome === realHome && betAway === realAway) {
      win = Math.floor(amount * 4.8);
      type = "–¢–û–ß–ù–´–ô –°–ß–Å–¢";
    } else if (betRes === realRes) {
      win = Math.floor(amount * 1.95);
      type = "–∏—Å—Ö–æ–¥";
    }

    if (win > 0) {
      balanceStars += win;
      tickets += 1; // –∑–∞ –≤—ã–∏–≥—Ä—ã—à ‚Äî –±–∏–ª–µ—Ç
      status.innerText =
        `‚úÖ –°—Ç–∞–≤–∫–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞: ${type}. –í—ã–∏–≥—Ä—ã—à +${win} ‚≠ê`;
    } else {
      status.innerText = "‚ùå –°—Ç–∞–≤–∫–∞ –Ω–µ —Å—ã–≥—Ä–∞–ª–∞. –í—ã–∏–≥—Ä—ã—à–∞ –Ω–µ—Ç.";
    }

    lastStrikeBet = null; // –æ–¥–Ω–∞ —Å—Ç–∞–≤–∫–∞ ‚Äî –æ–¥–∏–Ω —Ä–∞—Å—á—ë—Ç
    localStorage.removeItem(KEY_LAST_STRIKE);

    saveAll();
    updateBalancesUI();
    updateTicketsUI();
    updateLastStrikeInfo();
  }

  function adminSaveStrikeMatch() {
    if (!isAdmin) return;

    const h = document.getElementById("adminStrikeHome").value.trim();
    const a = document.getElementById("adminStrikeAway").value.trim();
    const t = document.getElementById("adminStrikeTimeText").value.trim();
    const d = document.getElementById("adminStrikeDeadline").value.trim();

    if (!h || !a || !t || !d) {
      alert("–ó–∞–ø–æ–ª–Ω–∏ –¥–æ–º, –≥–æ—Å—Ç–µ–π, —Ç–µ–∫—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–µ–¥–ª–∞–π–Ω.");
      return;
    }

    strikeMatch = {
      home: h,
      away: a,
      timeText: t,
      deadline: d
    };

    saveAll();
    initStrikeMatchUI();
    alert("–ú–∞—Ç—á –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —É–¥–∞—Ä–∞ –æ–±–Ω–æ–≤–ª—ë–Ω.");
  }

  // =============== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===============
  document.addEventListener("DOMContentLoaded", function () {
    applyAdminVisibility();

    updateBalancesUI();
    updateClubUI();
    updateTicketsUI();
    updatePointsAndStatsUI();
    rebuildTable();

    buildMatchesUserUI();
    buildMatchesAdminResultsUI();

    if (tourSent) {
      const btn = document.getElementById("predictionsButton");
      if (btn) btn.disabled = true;
      document.getElementById("predictionsResult").innerText =
        "–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Ç–µ–∫—É—â–∏–π —Ç—É—Ä —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ñ–¥—ë–º —Ä–∞—Å—á—ë—Ç–∞.";
    }

    initStrikeMatchUI();

    if (favoriteClub) {
      document.getElementById("clubSelect").style.display = "none";
      openScreen("home");
    } else {
      document.getElementById("clubSelect").style.display = "block";
    }
  });
</script>
</body>
</html>
